# 人机交互设计文档

## **文档作者**

主要编写者：戚俊涵

其他编写者：李祥郡 易飞翔 张铭恺

## **文档修改历史**

| 版本 | 日期       | 修改内容 | 修改人 |
| ---- | ---------- | -------- | ------ |
| 1    | 2025-05-05 | 初稿撰写 | 戚俊涵 |

## **目录**

## **1. 设计背景/思路**

SBEAM 是一个面向玩家的数字游戏分发平台，致力于提供类 Steam 的体验，包括游戏浏览、购买、好友等核心功能。本次人机交互设计重点聚焦于复现 Steam 的用户使用体验，通过对 Steam 的界面布局、功能流程、控件细节进行分析，对 SBEAM 平台进行模块化拆解与设计。

主要交互参考来源：

+ Steam 网页版的界面结构和导航逻辑
+ Steam 的“商店”、“库”、“社区”、“用户中心”等典型页面设计
+ 平台余额、第三方支付（支付宝）接入方式

设计原则：

+ **一致性**：交互风格保持统一，尽量还原 Steam 的设计语言
+ **响应性**：在 PC 端实现流畅的交互体验，适配多分辨率屏幕
+ **简洁性**：核心功能明确，简化操作路径，减少用户干扰

## **2. 业务流程**

1. 用户模块

    ```mermaid
    graph TD
        A[用户访问系统] --> B{是否已注册}
        B -->|否| C[用户注册]
        B -->|是| D[用户登录]
    C --> C1[填写注册信息]
    C1 --> C2[验证信息格式]
    C2 --> C3{验证是否通过}
    C3 -->|否| C4[显示错误信息]
    C4 --> C1
    C3 -->|是| C5[创建用户账户]
    C5 --> C6[发送注册成功通知]
    C6 --> D
    
    D --> D1[输入登录凭据]
    D1 --> D2[验证用户身份]
    D2 --> D3{验证是否成功}
    D3 -->|否| D4[显示登录失败]
    D4 --> D1
    D3 -->|是| D5[生成JWT Token]
    D5 --> D6[用户进入系统]
    
    D6 --> E[用户操作]
    E --> E1[查看个人信息]
    E --> E2[修改个人信息]
    E --> E3[管理游戏库存]
    E --> E4[查看交易记录]
    E --> E5[注销登录]
    
    E2 --> E21[验证修改权限]
    E21 --> E22[更新用户信息]
    E22 --> E23[保存到数据库]
    
    E5 --> E51[清除Token]
    E51 --> E52[返回登录页面]
    ```

2. 货物管理与查询模块

    ```mermaid
    graph TD
        A[管理员登录] --> B{权限验证}
        B -->|管理员| C[进入商品管理]
        B -->|普通用户| D[权限不足]
    C --> E[商品管理操作]
    E --> E1[创建商品]
    E --> E2[查询商品]
    E --> E3[更新商品]
    E --> E4[删除商品]
    E --> E5[库存管理]
    
    E1 --> E11[填写商品信息]
    E11 --> E12[上传商品图片]
    E12 --> E13[设置价格和折扣]
    E13 --> E14[设置库存数量]
    E14 --> E15[保存商品信息]
    E15 --> E16{保存是否成功}
    E16 -->|是| E17[商品创建成功]
    E16 -->|否| E18[显示错误信息]
    E18 --> E11
    
    E2 --> E21[输入查询条件]
    E21 --> E22[执行查询]
    E22 --> E23[显示查询结果]
    E23 --> E24[选择具体商品]
    E24 --> E25[查看商品详情]
    
    E3 --> E31[选择要更新的商品]
    E31 --> E32[修改商品信息]
    E32 --> E33[保存修改]
    E33 --> E34{更新是否成功}
    E34 -->|是| E35[更新成功]
    E34 -->|否| E36[显示错误信息]
    E36 --> E32
    
    E4 --> E41[选择要删除的商品]
    E41 --> E42[确认删除操作]
    E42 --> E43{确认删除}
    E43 -->|是| E44[执行删除]
    E43 -->|否| E45[取消删除]
    E44 --> E46[删除成功]
    
    E5 --> E51[查看库存状态]
    E51 --> E52[调整库存数量]
    E52 --> E53[设置库存预警]
    E53 --> E54[保存库存设置]
    ```

3. 交易与支付管理模块

    ```mermaid
    graph TD
        A[用户浏览商品] --> B[添加商品到购物车]
        B --> C[查看购物车]
        C --> D{是否继续购物}
        D -->|是| A
        D -->|否| E[结算购物车]
        
        E --> F[创建订单]
        F --> G[选择支付方式]
        G --> H[支付宝支付]
        
        H --> I[跳转支付宝]
        I --> J[用户完成支付]
        J --> K{支付是否成功}
        K -->|是| L[支付成功回调]
        K -->|否| M[支付失败处理]
        
        L --> N[扣减商品库存]
        N --> O[添加商品到用户库存]
        O --> P[增加抽奖次数]
        P --> Q[清空购物车]
        Q --> R[订单状态更新为成功]
        R --> S[发送支付成功通知]
        
        M --> T[订单状态更新为失败]
        T --> U[发送支付失败通知]
        U --> V[用户可重新支付]
        V --> G
        
        S --> W[用户查看订单]
        W --> X[用户查看游戏库存]
        
        Y[管理员] --> Z[查看所有订单]
        Z --> AA[订单状态管理]
        AA --> BB[退款处理]
        BB --> CC[库存回滚]
        CC --> DD[抽奖次数回滚]
    ```

4. 广告关系模块

    ```mermaid
    graph TD
        A[管理员登录] --> B{权限验证}
        B -->|管理员| C[进入广告管理]
        B -->|普通用户| D[权限不足]
        
        C --> E[广告管理操作]
        E --> E1[创建广告]
        E --> E2[查看广告列表]
        E --> E3[编辑广告]
        E --> E4[删除广告]
        E --> E5[广告统计分析]
        
        E1 --> E11[填写广告基本信息]
        E11 --> E12[上传广告图片]
        E12 --> E13[设置广告位置]
        E13 --> E14[设置展示时间]
        E14 --> E15[设置目标链接]
        E15 --> E16[预览广告效果]
        E16 --> E17{确认创建}
        E17 -->|是| E18[保存广告]
        E17 -->|否| E11
        E18 --> E19[广告创建成功]
        
        E2 --> E21[加载广告列表]
        E21 --> E22[显示广告状态]
        E22 --> E23[筛选和排序]
        E23 --> E24[查看广告详情]
        
        E3 --> E31[选择要编辑的广告]
        E31 --> E32[修改广告信息]
        E32 --> E33[更新广告图片]
        E33 --> E34[调整展示设置]
        E34 --> E35[保存修改]
        E35 --> E36{保存是否成功}
        E36 -->|是| E37[修改成功]
        E36 -->|否| E38[显示错误信息]
        E38 --> E32
        
        E4 --> E41[选择要删除的广告]
        E41 --> E42[确认删除警告]
        E42 --> E43{确认删除}
        E43 -->|是| E44[执行删除]
        E43 -->|否| E45[取消删除]
        E44 --> E46[删除成功]
        
        F[用户访问系统] --> G[加载首页]
        G --> H[获取广告列表]
        H --> I[按权重排序广告]
        I --> J[展示轮播广告]
        J --> K[用户点击广告]
        K --> L[跳转到目标页面]
        L --> M[记录点击统计]
    ```

5. 抽奖系统

    ```mermaid
    graph TD
        A[用户登录系统] --> B[查看抽奖次数]
        B --> C{是否有抽奖次数}
        C -->|否| D[提示购买商品获得抽奖次数]
        C -->|是| E[选择抽奖奖池]
        
        D --> D1[跳转到商店页面]
        D1 --> D2[用户购买商品]
        D2 --> D3[支付成功]
        D3 --> D4[自动增加抽奖次数]
        D4 --> E
        
        E --> F[查看奖池奖品]
        F --> G[确认参与抽奖]
        G --> H[扣除一次抽奖次数]
        H --> I[执行抽奖算法]
        
        I --> J{是否中奖}
        J -->|是| K[获得奖品]
        J -->|否| L[未中奖]
        
        K --> K1[将奖品添加到用户库存]
        K1 --> K2[从奖池中移除奖品]
        K2 --> K3[显示中奖结果]
        K3 --> M[记录抽奖历史]
        
        L --> L1[显示未中奖结果]
        L1 --> M
        
        M --> N{是否继续抽奖}
        N -->|是| C
        N -->|否| O[退出抽奖]
        
        P[管理员] --> Q[抽奖管理]
        Q --> Q1[创建奖池]
        Q --> Q2[添加奖品到奖池]
        Q --> Q3[设置奖品概率]
        Q --> Q4[管理奖池状态]
        Q --> Q5[查看抽奖统计]
        
        Q1 --> Q11[设置奖池名称]
        Q11 --> Q12[配置奖池参数]
        Q12 --> Q13[保存奖池]
        
        Q2 --> Q21[选择商品]
        Q21 --> Q22[设置奖品数量]
        Q22 --> Q23[设置中奖概率]
        Q23 --> Q24[添加到奖池]
    ```

6. 交友系统

    ```mermaid
    graph TD
        A[用户登录] --> B[进入好友系统]
        B --> C[好友管理功能]
        
        C --> C1[搜索用户]
        C --> C2[查看好友列表]
        C --> C3[管理好友申请]
        C --> C4[删除好友]
        
        C1 --> C11[输入用户手机号]
        C11 --> C12[搜索用户信息]
        C12 --> C13{用户是否存在}
        C13 -->|否| C14[显示用户不存在]
        C13 -->|是| C15[显示用户信息]
        C15 --> C16{是否已是好友}
        C16 -->|是| C17[显示已是好友]
        C16 -->|否| C18[发送好友申请]
        
        C18 --> C181[创建好友申请记录]
        C181 --> C182[发送申请通知]
        C182 --> C183[申请发送成功]
        
        C2 --> C21[获取好友列表]
        C21 --> C22[显示好友信息]
        C22 --> C23[查看好友详情]
        C23 --> C24[访问好友主页]
        
        C3 --> C31[查看待处理申请]
        C31 --> C32{是否有待处理申请}
        C32 -->|否| C33[显示无申请]
        C32 -->|是| C34[显示申请列表]
        C34 --> C35[选择申请操作]
        C35 --> C36[同意申请]
        C35 --> C37[拒绝申请]
        
        C36 --> C361[建立好友关系]
        C361 --> C362[删除申请记录]
        C362 --> C363[发送同意通知]
        C363 --> C364[好友添加成功]
        
        C37 --> C371[删除申请记录]
        C371 --> C372[发送拒绝通知]
        C372 --> C373[申请已拒绝]
        
        C4 --> C41[选择要删除的好友]
        C41 --> C42[确认删除操作]
        C42 --> C43{确认删除}
        C43 -->|是| C44[解除好友关系]
        C43 -->|否| C45[取消删除]
        C44 --> C46[删除成功]
        
        D[被添加用户] --> E[接收好友申请]
        E --> F[查看申请通知]
        F --> G[处理好友申请]
    ```

7. 好友聊天系统

    ```mermaid
    graph TD
        A[用户登录] --> B[进入好友系统]
        B --> C[好友管理功能]
        
        C --> C1[搜索用户]
        C --> C2[查看好友列表]
        C --> C3[管理好友申请]
        C --> C4[删除好友]
        
        C1 --> C11[输入用户手机号]
        C11 --> C12[搜索用户信息]
        C12 --> C13{用户是否存在}
        C13 -->|否| C14[显示用户不存在]
        C13 -->|是| C15[显示用户信息]
        C15 --> C16{是否已是好友}
        C16 -->|是| C17[显示已是好友]
        C16 -->|否| C18[发送好友申请]
        
        C18 --> C181[创建好友申请记录]
        C181 --> C182[发送申请通知]
        C182 --> C183[申请发送成功]
        
        C2 --> C21[获取好友列表]
        C21 --> C22[显示好友信息]
        C22 --> C23[查看好友详情]
        C23 --> C24[访问好友主页]
        
        C3 --> C31[查看待处理申请]
        C31 --> C32{是否有待处理申请}
        C32 -->|否| C33[显示无申请]
        C32 -->|是| C34[显示申请列表]
        C34 --> C35[选择申请操作]
        C35 --> C36[同意申请]
        C35 --> C37[拒绝申请]
        
        C36 --> C361[建立好友关系]
        C361 --> C362[删除申请记录]
        C362 --> C363[发送同意通知]
        C363 --> C364[好友添加成功]
        
        C37 --> C371[删除申请记录]
        C371 --> C372[发送拒绝通知]
        C372 --> C373[申请已拒绝]
        
        C4 --> C41[选择要删除的好友]
        C41 --> C42[确认删除操作]
        C42 --> C43{确认删除}
        C43 -->|是| C44[解除好友关系]
        C43 -->|否| C45[取消删除]
        C44 --> C46[删除成功]
        
        D[被添加用户] --> E[接收好友申请]
        E --> F[查看申请通知]
        F --> G[处理好友申请]
    ```

8. 智能客服系统

    ```mermaid
    graph TD
        A[用户访问客服] --> B[客服系统初始化]
        B --> C[客服服务类型]
        
        C --> C1[智能机器人客服]
        C --> C2[人工客服转接]
        C --> C3[常见问题查询]
        
        C1 --> C11[用户输入问题]
        C11 --> C12[问题预处理]
        C12 --> C13[关键词提取]
        C13 --> C14[意图识别]
        C14 --> C15{是否识别成功}
        
        C15 -->|是| C16[匹配答案库]
        C15 -->|否| C17[调用AI模型]
        
        C16 --> C161[查找标准答案]
        C161 --> C162{是否找到答案}
        C162 -->|是| C163[返回标准答案]
        C162 -->|否| C17
        
        C17 --> C171[发送给AI服务]
        C171 --> C172[AI生成回答]
        C172 --> C173[答案质量评估]
        C173 --> C174{答案是否合适}
        C174 -->|是| C175[返回AI答案]
        C174 -->|否| C176[转人工客服]
        
        C163 --> C18[记录对话日志]
        C175 --> C18
        C18 --> C19[用户满意度反馈]
        C19 --> C20{用户是否满意}
        C20 -->|是| C21[结束对话]
        C20 -->|否| C22[继续提问或转人工]
        
        C2 --> C23[检查人工客服状态]
        C23 --> C24{是否有空闲客服}
        C24 -->|是| C25[分配人工客服]
        C24 -->|否| C26[加入等待队列]
        
        C25 --> C251[建立人工对话]
        C251 --> C252[客服回答问题]
        C252 --> C253[问题解决确认]
        C253 --> C254[结束人工服务]
        
        C26 --> C261[显示等待信息]
        C261 --> C262[定时检查队列]
        C262 --> C24
        
        C3 --> C31[显示问题分类]
        C31 --> C32[选择问题类别]
        C32 --> C33[显示相关FAQ]
        C33 --> C34[查看具体问题]
        C34 --> C35{问题是否解决}
        C35 -->|是| C36[标记为有用]
        C35 -->|否| C37[转智能客服]
        C37 --> C1
        
        D[管理员] --> E[客服系统管理]
        E --> E1[知识库管理]
        E --> E2[对话记录分析]
        E --> E3[客服效果统计]
        E --> E4[AI模型优化]
    ```

## **3. 页面交互**

### **3.1 产品结构、信息结构**

**产品结构图**：

![产品结构图.drawio](https://s2.loli.net/2025/05/05/QG7oIRAbvE8fL2C.png)

**信息结构图**：

![image-20250621150318050](https://s2.loli.net/2025/06/21/FNic4dhvMQWoGSf.png)

### **3.2 操作流程图**

1. 用户模块

    ```mermaid
    sequenceDiagram
        participant U as 用户
        participant F as 前端
        participant B as 后端
        participant D as 数据库
        
        Note over U,D: 用户注册流程
        U->>F: 填写注册表单
        F->>F: 前端数据验证
        F->>B: 发送注册请求
        B->>B: 后端数据验证
        B->>D: 检查用户是否存在
        D->>B: 返回查询结果
        B->>B: 密码加密处理
        B->>D: 创建新用户
        D->>B: 返回创建结果
        B->>F: 返回注册成功
        F->>U: 显示注册成功信息
        
        Note over U,D: 用户登录流程
        U->>F: 输入登录信息
        F->>B: 发送登录请求
        B->>D: 验证用户凭据
        D->>B: 返回用户信息
        B->>B: 生成JWT Token
        B->>F: 返回Token和用户信息
        F->>F: 存储Token到SessionStorage
        F->>U: 跳转到主页面
        
        Note over U,D: 用户信息更新流程
        U->>F: 修改个人信息
        F->>B: 发送更新请求（携带Token）
        B->>B: 验证Token有效性
        B->>D: 更新用户信息
        D->>B: 返回更新结果
        B->>F: 返回更新成功
        F->>U: 显示更新成功信息
    ```

2. 货物管理与查询模块

    ```mermaid
    sequenceDiagram
        participant A as 管理员
        participant F as 前端
        participant B as 后端
        participant D as 数据库
        participant S as 文件存储
        
        Note over A,S: 商品创建流程
        A->>F: 填写商品创建表单
        F->>S: 上传商品图片
        S->>F: 返回图片URL
        F->>B: 发送商品创建请求
        B->>B: 验证管理员权限
        B->>B: 验证商品数据
        B->>D: 保存商品信息
        D->>B: 返回保存结果
        B->>F: 返回创建成功
        F->>A: 显示创建成功信息
        
        Note over A,S: 商品查询流程
        A->>F: 输入查询条件
        F->>B: 发送查询请求
        B->>D: 执行商品查询
        D->>B: 返回商品列表
        B->>F: 返回查询结果
        F->>A: 显示商品列表
        
        Note over A,S: 商品更新流程
        A->>F: 选择商品并修改信息
        F->>S: 上传新图片（如果有）
        S->>F: 返回新图片URL
        F->>B: 发送更新请求
        B->>B: 验证权限和数据
        B->>D: 更新商品信息
        D->>B: 返回更新结果
        B->>F: 返回更新成功
        F->>A: 显示更新成功信息
        
        Note over A,S: 库存管理流程
        A->>F: 查看库存状态
        F->>B: 请求库存信息
        B->>D: 查询库存数据
        D->>B: 返回库存信息
        B->>F: 返回库存状态
        F->>A: 显示库存信息
        A->>F: 调整库存数量
        F->>B: 发送库存更新请求
        B->>D: 更新库存数量
        D->>B: 返回更新结果
        B->>F: 返回更新成功
        F->>A: 显示库存更新成功
    ```

3. 交易与支付管理模块

    ```mermaid
    sequenceDiagram
        participant U as 用户
        participant F as 前端
        participant B as 后端
        participant D as 数据库
        participant P as 支付宝
        
        Note over U,P: 购物车操作流程
        U->>F: 添加商品到购物车
        F->>B: 发送添加请求
        B->>D: 保存购物车项目
        D->>B: 返回保存结果
        B->>F: 返回添加成功
        F->>U: 显示添加成功
        
        Note over U,P: 订单创建流程
        U->>F: 点击结算
        F->>B: 发送创建订单请求
        B->>D: 检查商品库存
        D->>B: 返回库存信息
        B->>B: 验证库存充足
        B->>D: 创建订单记录
        D->>B: 返回订单ID
        B->>F: 返回订单创建成功
        F->>U: 显示订单信息
        
        Note over U,P: 支付流程
        U->>F: 选择支付宝支付
        F->>B: 发送支付请求
        B->>B: 生成支付参数
        B->>P: 创建支付单
        P->>B: 返回支付页面
        B->>F: 返回支付页面URL
        F->>U: 跳转到支付宝页面
        U->>P: 完成支付操作
        P->>B: 支付结果回调
        B->>D: 查询订单信息
        D->>B: 返回订单详情
        
        Note over U,P: 支付成功处理
        B->>D: 扣减商品库存
        B->>D: 添加用户游戏库存
        B->>D: 增加用户抽奖次数
        B->>D: 清空用户购物车
        B->>D: 更新订单状态为成功
        D->>B: 返回处理结果
        B->>P: 返回success
        P->>F: 跳转回调页面
        F->>U: 显示支付成功页面
    ```

4. 广告关系模块

    ```mermaid
    sequenceDiagram
        participant A as 管理员
        participant F as 前端
        participant B as 后端
        participant D as 数据库
        participant S as 文件存储
        participant U as 用户
        
        Note over A,U: 广告创建流程
        A->>F: 填写广告创建表单
        F->>S: 上传广告图片
        S->>F: 返回图片URL
        F->>B: 发送广告创建请求
        B->>B: 验证管理员权限
        B->>B: 验证广告数据格式
        B->>D: 保存广告信息
        D->>B: 返回保存结果
        B->>F: 返回创建成功
        F->>A: 显示创建成功信息
        
        Note over A,U: 广告展示流程
        U->>F: 访问首页
        F->>B: 请求广告列表
        B->>D: 查询活跃广告
        D->>B: 返回广告数据
        B->>B: 按权重和时间排序
        B->>F: 返回排序后的广告
        F->>F: 初始化轮播组件
        F->>U: 展示广告轮播
        
        Note over A,U: 广告点击统计
        U->>F: 点击广告
        F->>B: 发送点击统计请求
        B->>D: 记录点击数据
        D->>B: 返回记录结果
        B->>F: 返回统计成功
        F->>U: 跳转到目标页面
        
        Note over A,U: 广告管理流程
        A->>F: 查看广告统计
        F->>B: 请求广告统计数据
        B->>D: 查询点击和展示统计
        D->>B: 返回统计数据
        B->>F: 返回统计结果
        F->>A: 显示统计图表
        
        A->>F: 编辑广告
        F->>B: 发送编辑请求
        B->>D: 更新广告信息
        D->>B: 返回更新结果
        B->>F: 返回编辑成功
        F->>A: 显示编辑成功信息
    ```

5. 抽奖系统

    ```mermaid
    sequenceDiagram
        participant U as 用户
        participant F as 前端
        participant B as 后端
        participant D as 数据库
        participant A as 管理员
        
        Note over A,D: 奖池创建流程
        A->>F: 创建新奖池
        F->>B: 发送奖池创建请求
        B->>B: 验证管理员权限
        B->>D: 保存奖池信息
        D->>B: 返回创建结果
        B->>F: 返回创建成功
        F->>A: 显示创建成功
        
        Note over A,D: 奖品配置流程
        A->>F: 添加奖品到奖池
        F->>B: 发送奖品配置请求
        B->>D: 查询商品信息
        D->>B: 返回商品数据
        B->>D: 创建抽奖物品记录
        D->>B: 返回创建结果
        B->>F: 返回配置成功
        F->>A: 显示配置成功
        
        Note over U,D: 用户抽奖流程
        U->>F: 进入抽奖页面
        F->>B: 请求用户抽奖次数
        B->>D: 查询用户信息
        D->>B: 返回用户数据
        B->>F: 返回抽奖次数
        F->>U: 显示抽奖次数
        
        U->>F: 选择奖池并抽奖
        F->>B: 发送抽奖请求
        B->>B: 验证用户抽奖次数
        B->>D: 扣除抽奖次数
        B->>D: 查询奖池奖品信息
        D->>B: 返回奖品列表
        B->>B: 执行抽奖算法
        B->>B: 判断是否中奖
        
        alt 中奖情况
            B->>D: 添加奖品到用户库存
            B->>D: 减少奖池奖品数量
            B->>D: 记录中奖记录
            D->>B: 返回处理结果
            B->>F: 返回中奖结果
            F->>U: 显示中奖动画和奖品
        else 未中奖情况
            B->>D: 记录未中奖记录
            D->>B: 返回记录结果
            B->>F: 返回未中奖结果
            F->>U: 显示未中奖结果
        end
        
        Note over U,D: 抽奖次数获取流程
        U->>F: 购买商品
        F->>B: 处理支付成功回调
        B->>D: 计算购买商品数量
        B->>D: 增加对应抽奖次数
        D->>B: 返回更新结果
        B->>F: 返回次数增加成功
        F->>U: 显示抽奖次数增加通知
    ```

6. 交友系统

    ```mermaid
    sequenceDiagram
        participant U1 as 用户A
        participant F1 as 前端A
        participant B as 后端
        participant D as 数据库
        participant F2 as 前端B
        participant U2 as 用户B
        
        Note over U1,U2: 搜索并添加好友流程
        U1->>F1: 输入用户B的手机号
        F1->>B: 发送用户搜索请求
        B->>D: 根据手机号查询用户
        D->>B: 返回用户B信息
        B->>B: 检查是否已是好友
        B->>F1: 返回用户信息和关系状态
        F1->>U1: 显示用户B信息
        
        U1->>F1: 点击添加好友
        F1->>B: 发送好友申请请求
        B->>B: 验证用户A身份
        B->>D: 创建好友申请记录
        D->>B: 返回创建结果
        B->>F1: 返回申请发送成功
        F1->>U1: 显示申请已发送
        
        Note over U1,U2: 好友申请处理流程
        U2->>F2: 查看好友申请
        F2->>B: 请求待处理申请列表
        B->>D: 查询用户B的待处理申请
        D->>B: 返回申请列表
        B->>F2: 返回申请数据
        F2->>U2: 显示申请列表
        
        U2->>F2: 同意用户A的申请
        F2->>B: 发送同意申请请求
        B->>D: 建立双向好友关系
        B->>D: 删除申请记录
        D->>B: 返回处理结果
        B->>F2: 返回同意成功
        F2->>U2: 显示好友添加成功
        
        Note over U1,U2: 好友列表查看流程
        U1->>F1: 查看好友列表
        F1->>B: 请求好友列表
        B->>D: 查询用户A的好友
        D->>B: 返回好友数据
        B->>F1: 返回好友列表
        F1->>U1: 显示好友列表
        
        Note over U1,U2: 删除好友流程
        U1->>F1: 选择删除某个好友
        F1->>B: 发送删除好友请求
        B->>D: 解除双向好友关系
        D->>B: 返回删除结果
        B->>F1: 返回删除成功
        F1->>U1: 显示删除成功信息
    ```

7. 好友聊天系统

    ```mermaid
    sequenceDiagram
        participant U1 as 用户A
        participant F1 as 前端A
        participant B as 后端
        participant D as 数据库
        participant F2 as 前端B
        participant U2 as 用户B
        
        Note over U1,U2: 聊天初始化流程
        U1->>F1: 选择好友B进行聊天
        F1->>B: 请求历史消息
        B->>D: 查询A和B的聊天记录
        D->>B: 返回历史消息
        B->>F1: 返回消息列表
        F1->>U1: 显示聊天界面和历史消息
        
        Note over U1,U2: 发送消息流程
        U1->>F1: 输入并发送消息
        F1->>F1: 验证消息内容
        F1->>B: 发送消息请求
        B->>B: 验证用户身份和好友关系
        B->>D: 保存消息记录
        D->>B: 返回保存结果
        
        alt 用户B在线
            B->>F2: 实时推送消息
            F2->>U2: 显示新消息通知
            U2->>F2: 查看消息
            F2->>B: 标记消息已读
            B->>D: 更新消息状态
        else 用户B离线
            B->>D: 标记为离线消息
            Note over B,D: 等待用户B上线后推送
        end
        
        B->>F1: 返回发送成功
        F1->>U1: 显示消息发送成功
        
        Note over U1,U2: 消息接收流程
        U2->>F2: 进入聊天页面
        F2->>B: 请求未读消息
        B->>D: 查询未读消息
        D->>B: 返回未读消息列表
        B->>F2: 返回未读消息
        F2->>U2: 显示未读消息提醒
        
        U2->>F2: 点击查看消息
        F2->>B: 发送已读确认
        B->>D: 更新消息已读状态
        D->>B: 返回更新结果
        B->>F2: 返回已读确认
        F2->>U2: 标记消息为已读
        
        Note over U1,U2: 消息历史查询流程
        U1->>F1: 查看更多历史消息
        F1->>B: 请求历史消息（分页）
        B->>D: 分页查询历史消息
        D->>B: 返回分页消息数据
        B->>F1: 返回历史消息
        F1->>U1: 显示更多历史消息
        
        Note over U1,U2: 消息删除流程
        U1->>F1: 删除某条消息
        F1->>B: 发送删除请求
        B->>B: 验证删除权限
        B->>D: 标记消息为已删除
        D->>B: 返回删除结果
        B->>F1: 返回删除成功
        F1->>U1: 移除消息显示
    ```

8. 智能客服系统

    ```mermaid
    sequenceDiagram
        participant U as 用户
        participant F as 前端
        participant B as 后端
        participant AI as AI服务
        participant D as 数据库
        participant A as 管理员
        
        Note over U,A: 智能客服对话流程
        U->>F: 进入客服页面
        F->>B: 初始化客服会话
        B->>D: 创建对话记录
        D->>B: 返回会话ID
        B->>F: 返回会话信息
        F->>U: 显示客服界面
        
        U->>F: 输入问题
        F->>B: 发送用户问题
        B->>B: 问题预处理和关键词提取
        B->>D: 查询知识库
        D->>B: 返回匹配结果
        
        alt 找到标准答案
            B->>F: 返回标准答案
            F->>U: 显示答案
        else 未找到标准答案
            B->>AI: 调用AI模型
            AI->>AI: 生成智能回答
            AI->>B: 返回AI回答
            B->>B: 评估答案质量
            B->>F: 返回AI答案
            F->>U: 显示AI回答
        end
        
        B->>D: 记录对话内容
        D->>B: 返回记录结果
        
        Note over U,A: 用户反馈流程
        U->>F: 给出满意度反馈
        F->>B: 发送反馈信息
        B->>D: 保存反馈数据
        D->>B: 返回保存结果
        B->>F: 返回反馈成功
        F->>U: 显示反馈确认
        
        Note over U,A: 人工客服转接流程
        U->>F: 请求人工客服
        F->>B: 发送转人工请求
        B->>D: 检查客服状态
        D->>B: 返回客服信息
        
        alt 有空闲客服
            B->>B: 分配人工客服
            B->>F: 返回分配成功
            F->>U: 连接人工客服
            U->>F: 与人工客服对话
            F->>B: 转发对话内容
            B->>D: 记录人工对话
        else 无空闲客服
            B->>F: 返回排队信息
            F->>U: 显示排队等待
            B->>B: 加入等待队列
            Note over B: 定时检查队列状态
        end
        
        Note over U,A: 管理员知识库管理
        A->>F: 登录管理后台
        F->>B: 验证管理员身份
        B->>F: 返回管理界面
        F->>A: 显示知识库管理
        
        A->>F: 添加/编辑FAQ
        F->>B: 发送知识库更新
        B->>D: 更新知识库内容
        D->>B: 返回更新结果
        B->>F: 返回更新成功
        F->>A: 显示更新确认
        
        Note over U,A: 客服效果分析
        A->>F: 查看客服统计
        F->>B: 请求统计数据
        B->>D: 查询对话记录和反馈
        D->>B: 返回统计数据
        B->>B: 分析客服效果
        B->>F: 返回分析结果
        F->>A: 显示统计图表
    ```

### **3.3 原型图**

![image-20250621150350827](https://s2.loli.net/2025/06/21/UYmXWsyZjlERMO8.png)
![image-20250621150408384](https://s2.loli.net/2025/06/21/nDxqQ8BApJwWgZi.png)
![image-20250621150420912](https://s2.loli.net/2025/06/21/jXHCoOlkPeycTMF.png)

## **4. 全局通用说明**

| 控件 | 类型            | 用法说明                   |
| ---- | --------------- | -------------------------- |
| 按钮 | 主按钮（蓝色）  | 例如“立即支付”、“立即购买” |
| 列表 | 卡片式游戏列表  | 展示游戏条目、购物车商品等 |
| 弹窗 | 支付确认 / 登录 | 使用模态方式居中弹出       |

### 4.1 常用控件

| 控件   | 类型           | 用法说明                   |
| ------ | -------------- | -------------------------- |
| 按钮   | 主要按钮       | 用于结算、确认操作         |
| 列表   | 游戏卡片式列表 | 应用于首页、分类页、购物车 |
| 标签栏 | 状态切换       | 订单筛选                   |
| 弹窗   | 模态弹窗       | 支付确认                   |

### 4.2 复用界面/组件

1. 游戏详情界面

2. 支付金额展示栏

3. 弹窗头部（用于登录、确认等）

### 4**.3** 单位规范

1. **金额单位**：人民币“¥”，统一为“¥xx.xx”格式

2. **时间格式**：

    + 相对时间：刚刚 / x分钟前 / 昨天 hh:mm

    + 绝对时间：2025/05/05（推荐用于订单时间、有效期）

3. **平台语言**：简体中文为默认，后期支持多语言切换功能

### 4**.4 缺省页汇总**

| 页面       | 状态       | 展示文案                             | 图标建议 |
| ---------- | ---------- | ------------------------------------ | -------- |
| 购物车为空 | 无数据     | 您的购物车空空如也                   | 🛒        |
| 游戏库为空 | 无已购游戏 | 您还未购买任何游戏，快去商城看看吧！ | 🎮        |
| 网络错误   | 网络异常   | 网络连接失败，请重试                 | 🌐⚠️       |

